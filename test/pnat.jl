using Test: @test
using LatticeProteins: pnat, potts,
    CONTACT_MAP_A, CONTACT_MAP_B, CONTACT_MAP_C, CONTACT_MAP_D

# From Lorenzo
@test pnat(6685, potts("WRFQDPGRCEEEDERMCGPEMCRCRQK")) ≈ 0.995663 rtol=1e-6
@test pnat(6685, potts("LEITKLEAVDDDRARFCQENLNGCKEQ")) ≈ 0.995402 rtol=1e-6
@test pnat(6685, potts("FELHKLKGFDGSTASLIKESFNNWKED")) ≈ 0.994070 rtol=1e-6

@test pnat(848, potts("RNISIMHVVVDLLTELTIMVAEYPQFP")) ≈ 1.45048e-07 rtol=1e-5
@test pnat(848, potts("RMMFFVPEMSKMGDFEHFKPEEYVAKW")) ≈ 0.988368 rtol=1e-6
@test pnat(848, potts("TGWLEWDDFRRKETVDDHRECPIKECM")) ≈ 0.993085 rtol=1e-6

@test pnat(625, potts("HCEVAVLKVRIEDQYCDCHDRVHFCTE")) ≈ 0.989353 rtol=1e-6

# From Hugo
@test pnat(CONTACT_MAP_A, potts("EKAMPAMDPDMAHEHKKKIRAWMFEGE")) ≈ 0.99463333079199023
@test pnat(CONTACT_MAP_A, potts("EKALNPVDTECWKEYKKKMRPVMLDAR")) ≈ 0.99281733038613029

@test pnat(CONTACT_MAP_B, potts("PDRFIVQCLAQFEHFERDGDKDMRAEC")) ≈ 0.98672675809463950
@test pnat(CONTACT_MAP_B, potts("KEHVECDRIKPKEEVANDEDKDLKCDF")) ≈ 0.99837746142507167

@test pnat(CONTACT_MAP_C, potts("ICEMDADLHCPKFPSFCRDWKAEKYEF")) ≈ 0.99411990031853326
@test pnat(CONTACT_MAP_C, potts("LPELDFKCKWAPFHCLHREMQMCQIKI")) ≈ 0.99546655562647968

@test pnat(CONTACT_MAP_D, potts("FKLTPQKACEGKDKELFQAWFCSCKRD")) ≈ 0.98983908221438699
@test pnat(CONTACT_MAP_D, potts("FEFCKIKKLSNAKRLMCGPGFESVNAE")) ≈ 0.99746046068117966
